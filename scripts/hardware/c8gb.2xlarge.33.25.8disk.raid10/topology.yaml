# =============================================================================
# Infrastructure Topology: c8gb.2xlarge.33.25.8disk.raid10
# =============================================================================
# This file documents the full infrastructure topology for this hardware context.
# Used for documentation and potentially for automated provisioning.
# =============================================================================

name: c8gb.2xlarge.33.25.8disk.raid10
description: "PostgreSQL on c8gb.2xlarge (block optimized) with 8-disk RAID10, PgCat proxy"

# -----------------------------------------------------------------------------
# Components
# -----------------------------------------------------------------------------
components:
  db:
    enabled: true
    count: 1
    instance_type: c8gb.2xlarge
    specs:
      vcpu: 8
      ram_gb: 16
      network_gbps: 33
      ebs_gbps: 25
    storage:
      data:
        disk_count: 8
        disk_size_gb: 50
        raid_level: 10
        usable_gb: 200
      wal:
        disk_count: 8
        disk_size_gb: 30
        raid_level: 10
        usable_gb: 120
    config: config.env

  proxy:
    enabled: true
    count: 1
    instance_type: c8g.2xlarge  # proxy doesn't need block optimized
    software: pgcat
    version: "1.3.0"
    config: proxy/pgcat.toml

  replica:
    enabled: false
    count: 0

  olap:
    enabled: false
    type: null  # risingwave, clickhouse, etc.

# -----------------------------------------------------------------------------
# Benchmark Results (from TUNING_NOTES.md)
# -----------------------------------------------------------------------------
benchmark:
  workload: pgbench_tpcb
  scale: 1250
  clients: 100
  results:
    tps_avg: 11469
    tps_peak: 15553
    tps_min: 6285
    latency_avg_ms: 8.70

# -----------------------------------------------------------------------------
# Cost Estimate (us-west-2, monthly)
# -----------------------------------------------------------------------------
cost:
  db_ondemand: 208.08
  db_spot: 62.64
  ebs_data: 25.60
  ebs_wal: 15.36
  proxy_ondemand: 208.08
  proxy_spot: 62.64
  total_ondemand: 457.12
  total_spot: 166.24
