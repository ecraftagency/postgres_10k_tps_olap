# =============================================================================
# Infrastructure Topology: r8g.2xlarge.15.10.8disk.raid10
# =============================================================================
# Price/Performance optimized configuration
# 37% better TPS/$ compared to c8gb.8xlarge
# =============================================================================

name: r8g.2xlarge.15.10.8disk.raid10
description: "PostgreSQL on r8g.2xlarge (memory optimized) - Best price/performance"

# -----------------------------------------------------------------------------
# Components
# -----------------------------------------------------------------------------
components:
  db:
    enabled: true
    count: 1
    instance_type: r8g.2xlarge
    specs:
      vcpu: 8
      ram_gb: 64
      network_gbps: 15
      ebs_gbps: 10
    storage:
      data:
        disk_count: 8
        disk_size_gb: 50
        raid_level: 10
        usable_gb: 200
      wal:
        disk_count: 8
        disk_size_gb: 30
        raid_level: 10
        usable_gb: 120
    config: config.env

  proxy:
    enabled: true
    count: 1
    instance_type: c8g.2xlarge
    software: pgcat
    version: "1.3.0"

  replica:
    enabled: false
    count: 0

# -----------------------------------------------------------------------------
# Benchmark Results
# -----------------------------------------------------------------------------
benchmark:
  workload: pgbench_tpcb
  scale: 1250
  clients: 100
  threads: 8
  duration: 60
  results:
    tps_avg: 19474
    tps_peak: 19723
    tps_min: 19076
    latency_avg_ms: 5.15
    io_cliff: false
    cache_hit_ratio: 99.9

# -----------------------------------------------------------------------------
# Price/Performance Analysis
# -----------------------------------------------------------------------------
price_performance:
  tps_per_dollar: 67.2
  vs_c8gb_8xlarge: "+37% better value"
  recommended_for: "workloads < 20K TPS"

# -----------------------------------------------------------------------------
# Cost Estimate (us-west-2, monthly)
# -----------------------------------------------------------------------------
cost:
  db_ondemand: 290.00
  db_spot: 87.00
  ebs_data: 25.60
  ebs_wal: 15.36
  proxy_ondemand: 208.08
  proxy_spot: 62.64
  total_ondemand: 539.04
  total_spot: 190.60
