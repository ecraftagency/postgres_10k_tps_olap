# =============================================================================
# COMMON NETWORK CONFIG: TCP/Network Tuning (ALL nodes)
# =============================================================================
# Apply to ALL nodes: primary, sync-replica, async-replica, proxy
# Critical for connection pooling and fast failure detection
# =============================================================================

# =============================================================================
# FILE DESCRIPTORS (common baseline)
# =============================================================================
FS_FILE_MAX=2097152

# =============================================================================
# NETWORK / TCP
# =============================================================================
NET_CORE_SOMAXCONN=65535
NET_CORE_NETDEV_MAX_BACKLOG=2048
NET_CORE_RMEM_DEFAULT=262144
NET_CORE_RMEM_MAX=16777216
NET_CORE_WMEM_DEFAULT=262144
NET_CORE_WMEM_MAX=16777216
NET_IPV4_TCP_RMEM="4096 87380 16777216"
NET_IPV4_TCP_WMEM="4096 65536 16777216"
NET_IPV4_TCP_MAX_SYN_BACKLOG=4096
NET_IPV4_TCP_TW_REUSE=1
NET_IPV4_TCP_FIN_TIMEOUT=15

# =============================================================================
# TCP KEEPALIVE (Critical for PgCat/PgBouncer - detect dead connections fast)
# =============================================================================
NET_IPV4_TCP_KEEPALIVE_TIME=60
NET_IPV4_TCP_KEEPALIVE_INTVL=10
NET_IPV4_TCP_KEEPALIVE_PROBES=6

# =============================================================================
# CONGESTION CONTROL (Use Google BBR for lower latency)
# =============================================================================
NET_CORE_DEFAULT_QDISC=fq
NET_IPV4_TCP_CONGESTION_CONTROL=bbr
