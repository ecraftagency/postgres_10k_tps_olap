# =============================================================================
# DB NODE OS CONFIG: Memory/HugePages/Ulimits (DB nodes only)
# =============================================================================
# Apply to: primary, sync-replica, async-replica
# NOT for proxy nodes
# =============================================================================

# =============================================================================
# MEMORY - VM Settings
# =============================================================================
VM_SWAPPINESS=1
VM_DIRTY_BACKGROUND_RATIO=1
VM_DIRTY_RATIO=4
VM_DIRTY_EXPIRE_CENTISECS=200
VM_DIRTY_WRITEBACK_CENTISECS=100
VM_OVERCOMMIT_MEMORY=2
VM_OVERCOMMIT_RATIO=80
VM_MIN_FREE_KBYTES=335544
VM_ZONE_RECLAIM_MODE=0
VM_VFS_CACHE_PRESSURE=100

# =============================================================================
# HUGEPAGES - For PostgreSQL shared_buffers
# =============================================================================
# Calculated: (8GB shared_buffers / 2MB hugepage) * 1.07 = 4382
VM_NR_HUGEPAGES=4382

# =============================================================================
# TRANSPARENT HUGE PAGES - Must be disabled for PostgreSQL
# =============================================================================
THP_ENABLED=never

# =============================================================================
# FILE DESCRIPTORS - DB specific
# =============================================================================
FS_AIO_MAX_NR=1048576
ULIMIT_NOFILE=65535
ULIMIT_NPROC=65535
